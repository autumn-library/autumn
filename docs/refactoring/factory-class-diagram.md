# Диаграмма классов после рефакторинга ФабрикаЖелудей

## Обзор изменений

В рамках рефакторинга ФабрикаЖелудей были выделены две новые ответственности в отдельные классы:

### НапильникМенеджер
**Ответственности:**
- Управление определениями напильников (ОпределенияНапильниковПоИмени, ОпределенияНапильников)
- Определение применимых напильников для желудей (ОпределитьПрименяемыеНапильники)
- Кэширование применяемых напильников (КэшПрименяемыхНапильников) 
- Управление списком инициализируемых напильников (ИнициализируемыеНапильники)
- Применение напильников к желудям (ПрименитьНапильники)
- Инициализация напильников (ПроинициализироватьНапильники)

**Методы:**
- `ДобавитьОпределениеНапильника(ОпределениеНапильника, Системный)`
- `ОпределитьПрименяемыеНапильники(ОпределениеЖелудя)`
- `ПрименитьНапильники(Желудь, ОпределениеЖелудя)`
- `ПроинициализироватьНапильники()`
- `ДобавитьИнициализируемыйНапильник(ИмяНапильника)`
- `УдалитьИнициализируемыйНапильник(ИмяНапильника)`
- `ПолучитьОпределениеНапильника(ИмяНапильника)`

### ПриемкаЗависимостей
**Ответственности:**
- Подготовка прилепляемых частиц для внедрения зависимостей
- Обработка блестяшек и других типов зависимостей
- Чтение метаданных о зависимостях из параметров методов

**Методы:**
- `ПодготовитьПрилепляемыеЧастицы(ОпределениеЖелудя, ПереданныеПрилепляемыеЧастицы)`
- `ПрочитатьПрилепляемыеЧастицыВМетоде(Метод, ВладелецСвойств)`

### ФабрикаЖелудей (упрощенная)
**Ответственности:**
- Создание желудей через метод НайтиЖелудь
- Управление определениями желудей (ОпределенияЖелудейПоИмени, ОпределенияЖелудейПоПрозвищу)
- Создание завязей (СоздатьЗавязь и связанные методы)
- Добавление дубов и напильников
- Чтение аннотаций и свойств желудей

## Диаграмма взаимодействия

```
ФабрикаЖелудей
├── НапильникМенеджер
│   ├── управляет напильниками
│   ├── определяет применимость
│   └── применяет к желудям
├── ПриемкаЗависимостей  
│   ├── подготавливает зависимости
│   └── обрабатывает блестяшки
└── базовая фабрика желудей
    ├── создает желуди
    ├── управляет определениями
    └── создает завязи
```

## Преимущества рефакторинга

1. **Разделение ответственностей** - каждый класс отвечает за свою область
2. **Упрощение кода** - основной класс стал меньше на 191 строку
3. **Улучшенная тестируемость** - компоненты можно тестировать независимо
4. **Лучшая поддерживаемость** - изменения в логике напильников не затрагивают основную фабрику
5. **Совместимость** - все существующие тесты проходят без изменений

## Обратная совместимость

Все публичные методы ФабрикаЖелудей сохранены и работают аналогично предыдущей версии. Клиентский код не требует изменений.